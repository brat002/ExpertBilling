<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
   <title>Установка и настройка веб-кабинета пользователя&nbsp;</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
<script type="text/javascript" src="helpman_topicinit.js"></script></head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#C0C0C0">
  <tr valign="middle">
    <td align="left">
      <p class="par3"><span class="fnt4">Установка и настройка веб-кабинета пользователя </span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="chapter_2.html">Top</a>&nbsp;
     <a href="new_item7.html">Previous</a>&nbsp;
     <a href="ianoieea_hotspot_ia_mikrotik_r.html">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">Рассмотрена установка веб-кабинета для ОС Debian/Ubuntu.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">1. Установим необходимые пакеты </span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p class="par1"><span class="fnt1">apt-get install apache2 libapache2-mod-python python-psycopg2 pyro python-dateutil python-pytils python-crypto python-twisted</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">2. Установим Django</span></p>
<p class="par1"><span class="fnt1">mkdir /opt/ebs/web/</span><br />
<span class="fnt1">cd /opt/ebs/web</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">Для получения свежей версии Django воспользуйтесь командой </span></p>
<p class="par1"><span class="fnt1">wget&nbsp;<a href="http://www.djangoproject.com/download/1.0.2/tarball/" target="_blank" class="weblink">UNREGISTERED EVALUATION VERSION</a>&nbsp;</span></p>
<p class="par1"><span class="fnt1">tar -xvzf Django-1.0.2-final.tar.gz</span><br />
<span class="fnt1">cp -r Django-1.0.2-final/django /opt/ebs/web/</span><br />
<span class="fnt1">rm -rf Django-1.0.2-final.tar.gz</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">3. Установка веб-кабинета</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">Копируем архив с кабинетом в папку /opt/ebs/web/:</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p class="par1"><span class="fnt1">cp -r /opt/ebs/data/ebscab/ebscab /opt/ebs/web/</span></p>
<p style="text-align: justify; text-indent: 47px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">4. Настройка кабинета</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 16px; font-family: 'Times New Roman';">Укажите параметры подключения к базе данных</span></p>
<p class="par1"><span class="fnt1">DATABASE_ENGINE = 'postgresql_psycopg2'</span><br />
<span class="fnt1">DATABASE_NAME = 'ebs'</span><br />
<span class="fnt1">DATABASE_USER = 'ebs'&nbsp;</span><br />
<span class="fnt1">DATABASE_PASSWORD = 'ebspassword'</span><br />
<span class="fnt1">DATABASE_HOST = '127.0.0.1'</span><br />
<span class="fnt1">DATABASE_PORT = '5432'</span></p>
<p><span style="font-size: 16px; font-family: 'Times New Roman';">Правильную временную зону(http://www.postgresql.org/docs/8.1/static/datetime-keywords.html#DATETIME-TIMEZONE-SET-TABLE)</span></p>
<p class="par1"><span class="fnt1">TIME_ZONE = 'Europe/Minsk'</span></p>
<p><span style="font-size: 16px; font-family: 'Times New Roman';">Путь к медиафайлам</span></p>
<p class="par1"><span class="fnt1">MEDIA_ROOT = '/opt/ebs/web/ebscab/media'</span></p>
<p><span style="font-size: 16px; font-family: 'Times New Roman';">Путь к директории с файлами шаблонов</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New';">TEMPLATE_DIRS = (</span></p>
<p><span style="font-family: 'Courier New';"> &nbsp;  </span><span style="font-family: 'Courier New'; font-style: italic; color: #00aa00;">'/opt/</span><span style="font-family: 'Courier New'; font-style: italic; color: #00aa00; text-decoration: underline;">ebs</span><span style="font-family: 'Courier New'; font-style: italic; color: #00aa00;">/web/</span><span style="font-family: 'Courier New'; font-style: italic; color: #00aa00; text-decoration: underline;">ebscab</span><span style="font-family: 'Courier New'; font-style: italic; color: #00aa00;">/templates'</span><span style="font-family: 'Courier New';">,</span></p>
<p><span style="font-family: 'Courier New';">)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 16px; font-family: 'Times New Roman';">В ExpertBilling 1.2 появилась возможность использовать услугу "Обещанный платёж". Параметры этой услуги для абонентов настроаиваются здесь же нижеследующими опциями.</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Courier New';">ALLOW_PROMISE = True #разрешить использование услуги</span></p>
<p><span style="font-family: 'Courier New';">MAX_PROMISE_SUM = 100000 #максимальная сумма, которую абонент может взять в долг</span></p>
<p><span style="font-family: 'Courier New';">LEFT_PROMISE_DAYS = 7 # Количество дней, по истечению которых с абонента будет взыскана взятая в долг сумма.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 16px; font-family: 'Times New Roman';">Настройка валюты отображения происходит через переменную </span><span style="font-size: 16px; font-family: 'Courier New';">CURRENCY</span><span style="font-size: 16px; font-family: 'Times New Roman';">.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">5. Настройка Apache </span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">Пропишите в файле /etc/apache2/sites-available/default следующие строки:</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-bottom: none; background: #ffff99;"><span class="fnt6">&lt;VirtualHost *:80&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;ServerAdmin webmaster@localhost</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;#ServerName www.ebscab.ru</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;DocumentRoot /opt/ebs/web/ebscab</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6" style="background-color: #ffff99;">&nbsp;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;Location "/"&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;SetHandler python-program</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;PythonHandler django.core.handlers.modpython</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;SetEnv DJANGO_SETTINGS_MODULE ebscab.settings</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span style="width:48px">&nbsp;</span><span class="fnt6"> &nbsp; &nbsp;PythonDebug On</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;PythonPath "['/opt/ebs/web','/opt/ebs/web/ebscab'] + sys.path"</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;/Location&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6" style="background-color: #ffff99;">&nbsp;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;Location "/media"&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;SetHandler None</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;/Location&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6" style="background-color: #ffff99;">&nbsp;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;Location "/admin_media"&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;SetHandler None</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;/Location&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6" style="background-color: #ffff99;">&nbsp;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;Alias /admin_media /opt/ebs/web/django/contrib/admin/media/</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;Directory /opt/ebs/web/django/contrib/admin/media/&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;Order allow,deny</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;Allow from all</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;/Directory&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;Alias /media /opt/ebs/web/ebscab/media/</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;Directory /opt/ebs/web/ebscab/media/&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;Order allow,deny</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;Allow from all</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;/Directory&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6" style="background-color: #ffff99;">&nbsp;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;LocationMatch "\.(jpg|gif|png)$"&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp; &nbsp; &nbsp;SetHandler None</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;&lt;/LocationMatch&gt;</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;CustomLog /opt/ebs/web/access.log combined</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; border-bottom: none; background: #ffff99;"><span class="fnt6"> &nbsp; &nbsp;ErrorLog /opt/ebs/web/error.log</span></p>
<p class="par5" style="border-color: #000000; border-style: solid; border-width: 1px; border-top: none; background: #ffff99;"><span class="fnt6">&lt;/VirtualHost&gt;</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">&lt;server ip&gt; - замените на IP адрес сервера или *, если веб-кабинет должен быть доступен со всех IP адресов</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">Теперь необходимо перезапустить Apache командой </span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p class="par1"><span class="fnt1">/etc/init.d/apache2 restart&nbsp;</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="font-size: 16px; font-family: 'Times New Roman';">Теперь можно попробовать открыть веб-кабинет по адресу, указанному в конфигурационном файле Apache. Если возникнут проблемы, обратитесь к файлу &nbsp;/opt/ebs/web/error.log</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<hr noshade="noshade" size="1" /><p>This help file was created with an unregistered evaluation copy of Help &amp; Manual. © EC Software. All rights reserved. This message will not appear if you compile this help file with the registered version of Help &amp; Manual.</p>

</td></tr></table>

</body>
</html>
