{% extends "ebsadmin/base.html" %}
{% load bootstrap_toolkit %}
{% block extra_head %}
        <script src="/media/jquery/js/jquery.maskedinput-1.3.min.js" type="text/javascript"></script>
	    <script src="/media/jscal/src/js/jscal2.js"></script>
	    <script src="/media/jscal/src/js/lang/ru.js"></script>
	    <link rel="stylesheet" type="text/css" href="/media/jscal/src/css/jscal2.css" />
	    <link rel="stylesheet" type="text/css" href="/media/jscal/src/css/border-radius.css" />
	    <link rel="stylesheet" type="text/css" href="/media/jscal/src/css/win2k/win2k.css" />
        <script type="text/javascript" src="/media/highcharts/js/highcharts.js"></script>  
        <script type="text/javascript"> 
        $(document).ready(function() {


            Calendar.setup({
                inputField : "id_start_date_0",
                trigger    : "id_start_date_0",
                onSelect   : function() { this.hide(); $.cookie('charts_date_start', $('#id_start_date_0').val()); },
                dateFormat : "%Y-%m-%d"
              });
            $("#id_start_date_1").mask("99:99:99");
            Calendar.setup({
                inputField : "id_end_date_0",
                trigger    : "id_end_date_0",
                onSelect   : function() { this.hide(); $.cookie('charts_date_end', $('#id_end_date_0').val()); },
                dateFormat : "%Y-%m-%d"
              });
            $("#id_end_date_1").mask("99:99:99");

        
        var charts_date_start = $.cookie('charts_date_start');
        if (charts_date_start && $('#id_start_date_0').val!='') {
            $('#id_start_date_0').val(charts_date_start);
        }

        var charts_date_end = $.cookie('charts_date_end');
        if (charts_date_end && $('#id_end_date_0').val!='') {
            $('#id_end_date_0').val(charts_date_end);
        }

        var charts_time_start = $.cookie('charts_time_start');
        if (charts_time_start && $('#id_start_date_1').val!='') {
            $('#id_start_date_1').val(charts_time_start);
        }

        var charts_time_end = $.cookie('charts_time_end');
        if (charts_time_end && $('#id_end_date_1').val!='') {
            $('#id_end_date_1').val(charts_time_end);
        }
        $('#id_start_date_1').change(function(e){
        	$.cookie('charts_time_start', $('#id_start_date_1').val())
        })
        
        $('#id_end_date_1').change(function(e){
            $.cookie('charts_time_end', $('#id_end_date_1').val())
        })

          });
        </script>
{% block chart_block %}
{% endblock %}

{% endblock %}
 {% load render_table from django_tables2 %}
{% block body %}

<div class="span12">
<div class="row-fluid">
<ul class="nav nav-tabs" id="tab-panel">
  <li><a href="#general" data-toggle="tab">Настройки</a></li>
  <li><a href="#commands" data-toggle="tab">Отчёт</a></li>
</ul>
<form id="id_form" method="GET" action="{% url charts %}?report={{form.report.value}}" class="well form-horizontal">

<div class="tab-content">
  <div class="tab-pane active" id="general">
            <legend>Параметры отчёта: {{rep.name}}</legend>
             <fieldset>
             {{form.report}}
                   <div class="control-group">
                      <label class="control-label"><strong>{{form.start_date.label}}: </strong></label>
                      <div class="controls">
                      {{ form.start_date }}
                      {% if form.start_date.errors %}
                          <span class="help-inline">{% for error in form.start_date.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.start_date.help_text%}
                          <p class="help-block">
                              {{ form.start_date.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                  </div>  
                   <div class="control-group">
                      <label class="control-label"><strong>{{form.end_date.label}}: </strong></label>
                      <div class="controls">
                      {{ form.end_date }}
                      {% if form.end_date.errors %}
                          <span class="help-inline">{% for error in form.end_date.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.end_date.help_text%}
                          <p class="help-block">
                              {{ form.end_date.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                  </div>  
                  
                  {% if 'accountsTab' in rep.tabs %}
                   <div class="control-group">
                      <label class="control-label"><strong>{{form.accounts.label}}: </strong></label>
                      <div class="controls">
                      {{ form.accounts }}
                      {% if form.accounts.errors %}
                          <span class="help-inline">{% for error in form.accounts.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.accounts.help_text%}
                          <p class="help-block">
                              {{ form.accounts.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                  </div>  
                  {% endif %}
                  
                   <div class="control-group">
                   {% if 'nassesTab' in rep.tabs %}
                   <div class="control-row">
                      <label class="control-label"><strong>{{form.nasses.label}}: </strong></label>
                      <div class="controls">
                      {{ form.nasses }}
                      {% if form.nasses.errors %}
                          <span class="help-inline">{% for error in form.nasses.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.nasses.help_text%}
                          <p class="help-block">
                              {{ form.nasses.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                  </div>  
                  {% endif %}
                  {% if 'tariffsTab' in rep.tabs %}
                  <div class="control-row">
                      <label class="control-label"><strong>{{form.tariffs.label}}: </strong></label>
                      <div class="controls">
                      {{ form.tariffs }}
                      {% if form.tariffs.errors %}
                          <span class="help-inline">{% for error in form.tariffs.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.tariffs.help_text%}
                          <p class="help-block">
                              {{ form.tariffs.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                      </div>
                      {% endif %}
                  </div>  

                   <div class="control-group">
                   {% if 'classesTab' in rep.tabs %}
                   <div class="control-row">
                      <label class="control-label"><strong>{{form.classes.label}}: </strong></label>
                      <div class="controls">
                      {{ form.classes }}
                      {% if form.classes.errors %}
                          <span class="help-inline">{% for error in form.classes.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.classes.help_text%}
                          <p class="help-block">
                              {{ form.classes.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                      </div>
                      {% endif %}
                      {% if 'groupsTab' in rep.tabs %}
                   <div class="control-row">
                      <label class="control-label"><strong>{{form.groups.label}}: </strong></label>
                      <div class="controls">
                      {{ form.groups }}
                      {% if form.groups.errors %}
                          <span class="help-inline">{% for error in form.groups.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.groups.help_text%}
                          <p class="help-block">
                              {{ form.groups.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                  </div> 
                  {% endif %}
                  </div>  
 

                   <div class="control-group">
                      <label class="control-label"><strong>{{form.grouping.label}}: </strong></label>
                      <div class="controls">
                      {{ form.grouping }}
                      {% if form.grouping.errors %}
                          <span class="help-inline">{% for error in form.grouping.errors %}{{ error }}<br/> {% endfor %}</span>
                      {% endif %}
                      {% if form.grouping.help_text%}
                          <p class="help-block">
                              {{ form.grouping.help_text|safe }}
                          </p>
                      {% endif %}
                      </div>
                  </div>  
             </fieldset>
</div>
  <div class="tab-pane" id="commands">

                   <div class="control-group">
                   {{reporttype}}
                      <div id='container' class="span11" style="min-width: 400px; height: {{len}}px; margin: 0 auto"> Chart will be rendered here </div>
                  </div>  
  </div>
</div>

                <fieldset>
                    <div class="form-actions form-actions-center">
                        <button class="btn btn-primary" type="submit">Сохранить</button>
                    </div>
                </fieldset>
            </form>

        </div>

    </div>

 {% endblock %}

